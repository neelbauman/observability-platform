# config/tempo/config.yml (★ 構文 修正版 3)

server:
  http_listen_port: 3200 # Grafanaが接続に来るHTTPポート

# ★ 修正点: 'distributor' がトップレベルキー
distributor:
  receivers: # ★ 'receivers' は 'distributor' の配下
    otlp:  # ★ 'otlp' は 'receivers' の配下
      protocols:
        grpc:
          # OTel CollectorからOTLP gRPCで受け取るポート
          endpoint: 0.0.0.0:4318 
        # (必要ならhttpも有効化できる)
        # http:
        #   endpoint: 0.0.0.0:4319

# ストレージ設定 (これは正しかった)
storage:
  trace:
    backend: local
    local:
      path: /var/tempo # コンテナ内の永続化パス

# 内部コンポーネント設定 (このままでOK)
ingester:
  lifecycler:
    ring:
      replication_factor: 1
      kvstore:
        store: memberlist

compactor:
  compaction:
    block_retention: 1h # 開発用にデータ保持期間を短く設定

memberlist:
  bind_port: 7946
  join_members:
    - tempo